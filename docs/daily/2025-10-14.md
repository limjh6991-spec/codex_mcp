# 2025-10-14 일일 로그

## 요약
- Isaac RL 환경에 조인트 별칭/역매핑 로직을 추가하고 도메인 랜덤라이제이션 목표 범위를 재조정해 학습·재생 경로의 일관성을 확보했다.
- 새 설정으로 `training/train_ppo.py --device cpu` 재학습을 수행해 `policies/ppo_roarm_retrained.zip`을 생성하고, GUI 재생 스크립트로 500스텝을 수집했다.
- 원격 GUI 세션에서는 Isaac 창이 표시되지 않는 증상을 확인했으며, 로그상으로는 시뮬레이션이 진행되었으나 시각화 출력 경로 점검이 필요하다.

## 환경 상태
| 항목 | 값 | 비고 |
| --- | --- | --- |
| Isaac Sim | 5.0 (pip install, Python 3.11 전용 venv) | `scripts/activate_isaacsim_env.sh`로 활성화 |
| RL 디바이스 | CPU (PyTorch 2.10.0.dev+cu128, SB3 2.x) | GUI 재생 시에도 CPU PPO 정책 사용 |
| 정책 산출물 | `policies/ppo_roarm_retrained.zip` | 10k 스텝 학습 후 저장 |

## 주요 작업
1. **도메인 랜덤라이제이션 재정렬**
   - `configs/domain_randomization.yaml`의 각 관절 목표 범위를 중간값 중심으로 축소하여 초기 단계를 좁은 작업공간에 집중.
   - `src/envs/isaac_roarm_env.py`에서 랜덤 목표가 실제 Articulation 조인트 순서를 따르도록 별칭/역매핑 테이블을 생성.
2. **PPO 재학습**
   - `source scripts/activate_isaacsim_env.sh && python training/train_ppo.py --env-kind isaac --device cpu --policy-output policies/ppo_roarm_retrained --isaac-stage assets/roarm_m3/usd/roarm_m3_patched.usd --isaac-articulation-prim /World/roarm --isaac-robot-usd assets/roarm_m3/usd/roarm_m3_patched.usd --domain-randomizer configs/domain_randomization.yaml` 실행.
   - 10,240 스텝 학습 완료 후 정책 저장, Isaac 종료 경고는 기존과 동일(Replicator 카테고리, audio context 등).
3. **GUI 재생 검증**
   - `python scripts/play_roarm_policy.py --policy policies/ppo_roarm_retrained.zip --usd assets/roarm_m3/usd/roarm_m3_patched.usd --isaac-articulation-prim /World/roarm --isaac-robot-usd assets/roarm_m3/usd/roarm_m3_patched.usd --episodes 1 --steps 500 --slow-ms 20 --seed 47` 실행.
   - 콘솔 로그 기준 500스텝까지 진행되고 누적 보상 -2644.434 기록. 그러나 원격 GUI 창이 비어 있어 시각 확인 불가.

## 발견 사항
- 관측/행동 순서는 별칭 매핑 이후 일치하며, `info["joint_names"]`에 실제 조인트 순서를 추가해 디버깅 용이.
- 재생 중 목표 달성 신호가 발생하지 않아 `within_tol` 항목이 0으로 유지, 보상 음수 누적.
- GUI 출력이 비어 있으나 SimulationApp 로그는 정상 진행을 보여 Omniverse UI 스트림 경로 또는 원격 세션 그래픽 포워딩 문제로 추정.

## 이슈 및 리스크
- GUI 공백 현상이 지속되면 정책 확인 절차를 대체할 시각화/로그 수집 루틴 필요.
- Reward 구조 재검토 없이 목표 범위만 조정한 상태라 실제 추적 성능 개선 여부가 불명확.

## 다음 계획
- GUI 공백 문제 재현 후 Vulkan/GLX/EGL 경로를 다시 점검하고, 필요 시 영상 캡처/스크린샷 자동화 도입 검토.
- 재생 세션에서 `info` 딕셔너리를 로깅하거나 joint 트래이스를 저장해 목표 대비 오차를 분석.
- 향후 실측 데이터를 기반으로 도메인 랜덤라이제이션 파라미터를 보강하고 reward 구성을 재평가.
