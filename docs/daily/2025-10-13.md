# 2025-10-13 일일 로그

## 요약
- Isaac Sim 헤드리스 환경이 AMD iGPU 경로로 초기화되면서 발생하던 초기 세그폴트를 재현 후, Vulkan/GLX/EGL 전 경로를 RTX 5090으로 강제하도록 런타임 변수를 재구성했다.
- `scripts/activate_isaacsim_env.sh`에 NVIDIA 전용 ICD·EGL·Mesa 오버라이드를 기본값으로 추가하여, 향후 세션에서도 동일한 설정이 자동으로 적용되도록 표준화했다.
- `python scripts/open_roarm_m3_gui.py --mode train` 헤드리스 런이 13만 스텝 이상 연속 수행되며 더 이상 비정상 종료가 발생하지 않음을 확인했다.

## 환경 상태
| 항목 | 값 | 비고 |
| --- | --- | --- |
| GPU 경로 | NVIDIA RTX 5090 (Vulkan/GLX/EGL) | `VK_ICD_FILENAMES=/usr/share/vulkan/icd.d/nvidia_icd.json`, `MESA_LOADER_DRIVER_OVERRIDE=nvidia` 적용 |
| Isaac Sim | 5.0.0-rc.45 (pip, Python 3.11) | `scripts/activate_isaacsim_env.sh` 갱신 버전 사용 |
| Launcher | `scripts/open_roarm_m3_gui.py --mode train` | 120k+ steps 루프 실행, 에러 미발생 |

## 수행 작업
1. **GPU 스택 강제 전환**
   - `/etc/vulkan/icd.d/nvidia_icd.json` 접근 실패를 확인 후 `/usr/share/vulkan/icd.d/nvidia_icd.json`로 경로를 교정.
   - `glxinfo -B`/`eglinfo -B`를 통해 OpenGL/EGL 벤더가 NVIDIA로 고정되는지 검증하고, `__GLX_VENDOR_LIBRARY_NAME`, `__NV_PRIME_RENDER_OFFLOAD`, `MESA_LOADER_DRIVER_OVERRIDE`, `__VK_LAYER_NV_optimus` 등을 조합하여 llvmpipe·RADV 경로 차단.
2. **환경 스크립트 업데이트**
   - `scripts/activate_isaacsim_env.sh`에 NVIDIA ICD·Mesa·EGL 벤더 기본값을 포함시켜 재부팅/재로그인 이후에도 설정이 유지되도록 반영.
3. **헤드리스 런 검증**
   - 갱신된 환경에서 `python scripts/open_roarm_m3_gui.py --mode train` 실행.
   - `[open_roarm_m3_gui] headless loop steps=139200, elapsed=34.7s` 등 장시간 루프 로그를 확인하고 더 이상 pre-startup crash가 발생하지 않음을 확인.

## 결과
- Isaac Sim 헤드리스 세션이 AMD iGPU 경로로 진입하면서 즉시 크래시 나던 문제가 해소되어, 장시간 러닝이 안정적으로 가능해졌다.
- NVIDIA-only 설정이 `activate_isaacsim_env.sh`에 기본값으로 내장되어 재현 가능성과 팀원 공유 절차가 단순화되었다.

## 다음 계획
- 다중 GPU 환경에서 EGL surfaceless/GBM 초기화를 자동 진단하는 스크립트 추가 검토.
- 헤드리스 런 중 메트릭 수집(IPC/Prometheus) 재활성화 및 장기 soak 모드에서의 성능 데이터 확보.
- Replicator/렌더러 확장 토글을 세분화하여 필요한 최소 구성만 유지하는 정책 수립.
