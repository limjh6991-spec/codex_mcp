{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "schema_version": 1,
    "title": "RoArmM3 Obs/Action Schema",
    "type": "object",
    "required": [
        "schema_version",
        "observation",
        "action"
    ],
    "properties": {
        "schema_version": {
            "type": "integer",
            "minimum": 1
        },
        "timestamp_wall": {
            "type": "number"
        },
        "timestamp_sim": {
            "type": [
                "number",
                "null"
            ]
        },
        "observation": {
            "type": "object",
            "required": [
                "obs_version",
                "q",
                "dq"
            ],
            "properties": {
                "obs_version": {
                    "type": "integer"
                },
                "joint_names": {
                    "type": ["array", "null"],
                    "items": {"type": "string"},
                    "description": "Optional ordered joint name list matching q/dq arrays; provided after real robot spec integration."
                },
                "q": {
                    "type": "array",
                    "items": {
                        "type": "number"
                    }
                },
                "dq": {
                    "type": "array",
                    "items": {
                        "type": "number"
                    }
                },
                "goal_delta": {
                    "type": "array",
                    "items": {
                        "type": "number"
                    }
                },
                "extra": {
                    "type": [
                        "object",
                        "null"
                    ]
                }
            }
        },
        "action": {
            "type": "object",
            "required": [
                "action_version",
                "delta"
            ],
            "properties": {
                "action_version": {
                    "type": "integer"
                },
                "delta": {
                    "type": "array",
                    "items": {
                        "type": "number"
                    }
                },
                "action_scale_hint": {
                    "type": ["number", "null"],
                    "description": "Optional scale applied to raw policy output prior to clipping; informs downstream normalization."
                },
                "raw_policy": {
                    "type": "array",
                    "items": {
                        "type": "number"
                    }
                },
                "rate_limited": {
                    "type": "boolean"
                },
                "clipped": {
                    "type": "boolean"
                }
            }
        },
        "rand_hash": {
            "type": [
                "string",
                "null"
            ]
        },
        "episode_id": {
            "type": [
                "string",
                "null"
            ]
        },
        "step_index": {
            "type": [
                "integer",
                "null"
            ],
            "minimum": 0
        }
    }
}